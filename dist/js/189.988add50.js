"use strict";(self["webpackChunkwakuwaku"]=self["webpackChunkwakuwaku"]||[]).push([[189],{5568:function(t,e,l){l.r(e),l.d(e,{default:function(){return At}});var i=l(6252),a=l(3577),c=l(1159);const s={class:"mx-3"},o={class:"text-end"},r=(0,i._)("i",{class:"fa-solid fa-plus"},null,-1),n=(0,i.Uk)(" 新增文章 "),d=[r,n],p={class:"table mt-4"},u=(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",{style:{width:"300px"}},"封面圖片"),(0,i._)("th",null,"文章種類"),(0,i._)("th",null,"名稱"),(0,i._)("th",null,"作者"),(0,i._)("th",null,"ID"),(0,i._)("th",null,"是否公開"),(0,i._)("th",null,"編輯")])],-1),m=["src"],h={key:1,style:{"max-height":"100px"},src:c,alt:""},_={class:"fw-bold fs-5"},b={key:0,class:"text-primary"},g={key:1,style:{color:"#18b16a"}},f={key:0,class:"text-success fw-bolder"},w={key:1,class:"text-muted fw-bolder"},y={class:"btn-group"},v=["onClick"],k=["onClick"];function A(t,e,l,c,r,n){const A=(0,i.up)("ArticleModal"),x=(0,i.up)("DelModal");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",s,[(0,i._)("div",o,[(0,i._)("button",{class:"btn btn-primary col-1 me-5",onClick:e[0]||(e[0]=t=>n.openArticleModal(!0))},d)]),(0,i._)("table",p,[u,(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.articles,(t=>((0,i.wg)(),(0,i.iD)("tr",{key:t.id},[(0,i._)("td",null,[t.coverImg?((0,i.wg)(),(0,i.iD)("img",{key:0,style:{"max-height":"100px"},src:t.coverImg,alt:""},null,8,m)):((0,i.wg)(),(0,i.iD)("img",h))]),(0,i._)("td",_,["event"===t.article_type?((0,i.wg)(),(0,i.iD)("span",b,"活動")):(0,i.kq)("",!0),"guide"===t.article_type?((0,i.wg)(),(0,i.iD)("span",g,"導購")):(0,i.kq)("",!0)]),(0,i._)("td",null,(0,a.zw)(t.title),1),(0,i._)("td",null,(0,a.zw)(t.author),1),(0,i._)("td",null,(0,a.zw)(t.id),1),(0,i._)("td",null,[!0===t.isPublic?((0,i.wg)(),(0,i.iD)("span",f,"公開")):((0,i.wg)(),(0,i.iD)("span",w,"未公開"))]),(0,i._)("td",null,[(0,i._)("div",y,[(0,i._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>n.openArticleModal(!1,t.id)}," 編輯 ",8,v),(0,i._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>n.openDelModal(t)}," 刪除 ",8,k)])])])))),128))])])]),(0,i.Wm)(A,{ref:"articleModal",is_new:r.isNew,article:r.tempArticle,onUpdate_article:n.updateArticle},null,8,["is_new","article","onUpdate_article"]),(0,i.Wm)(x,{ref:"delModal","item-title":r.tempArticle.title,"item-id":r.tempArticle.id,onDeleteItem:n.deleteArticle},null,8,["item-title","item-id","onDeleteItem"])],64)}var x=l(9963);const M={class:"modal fade",id:"articleModal","data-bs-backdrop":"static","data-bs-focus":"false",tabindex:"-1",role:"dialog","aria-labelledby":"articleModalLabel","aria-hidden":"true",ref:"modal"},U={class:"modal-dialog modal-xl modal-dialog-scrollable",role:"document"},D={class:"modal-content"},I=(0,i._)("div",{class:"modal-header"},[(0,i._)("h5",{class:"modal-title",id:"articleModalLabel"},"編輯文章"),(0,i._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$={class:"modal-body"},C={class:"row"},N={class:"col-md-3 col-12"},P={class:"mb-1"},V=(0,i._)("p",{class:"mb-1 p-0"},"文章種類",-1),E={class:"d-flex justify-content-around"},F={class:"form-check"},L=(0,i._)("label",{for:"article_type_1",class:"form-check-label"},"活動 Event",-1),Z={class:"form-check"},j=(0,i._)("label",{for:"article_type_2",class:"form-check-label"},"導購 Guide",-1),z={key:0,class:"mb-1"},q={for:"campaign_url",class:"form-label w-100"},G=(0,i.Uk)("導購網址 "),W=["disabled"],H={class:"mb-1"},S={for:"title",class:"form-label w-100"},T=(0,i.Uk)("名稱 "),Y={class:"mb-1"},B={for:"author",class:"form-label w-100"},K=(0,i.Uk)("作者 "),O={class:"mb-1"},J={for:"cover_img",class:"form-label w-100"},Q=(0,i.Uk)("封面圖片 (1300x400) "),R={class:"input-group"},X=(0,i._)("i",{class:"bi bi-file-earmark-arrow-up"},null,-1),tt=[X],et={class:"form-check ms-1 fs-5 fw-bold"},lt={class:"form-check-label",for:"is_public"},it=(0,i.Uk)(" 是否公開 "),at={class:"col-md-9 col-12"},ct={class:"d-flex justify-content-center"},st=["src"],ot=(0,i._)("hr",null,null,-1),rt={class:"col-md-12 mt-2"},nt=(0,i._)("p",null,"文章內容 (導購不會顯示)",-1),dt=(0,i._)("p",null,"預覽文章內容",-1),pt={class:"modal-footer"},ut=(0,i._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function mt(t,e,l,c,s,o){const r=(0,i.up)("documentEditor");return(0,i.wg)(),(0,i.iD)("div",M,[(0,i._)("div",U,[(0,i._)("div",D,[I,(0,i._)("div",$,[(0,i._)("div",C,[(0,i._)("div",N,[(0,i._)("div",P,[V,(0,i._)("div",E,[(0,i._)("div",F,[(0,i.wy)((0,i._)("input",{type:"radio",class:"form-check-input",id:"article_type_1",name:"article_type",value:"event","onUpdate:modelValue":e[0]||(e[0]=t=>s.tempArticle.article_type=t)},null,512),[[x.G2,s.tempArticle.article_type]]),L]),(0,i._)("div",Z,[(0,i.wy)((0,i._)("input",{type:"radio",class:"form-check-input",id:"article_type_2",name:"article_type",value:"guide","onUpdate:modelValue":e[1]||(e[1]=t=>s.tempArticle.article_type=t)},null,512),[[x.G2,s.tempArticle.article_type]]),j])])]),"event"!==s.tempArticle.article_type?((0,i.wg)(),(0,i.iD)("div",z,[(0,i._)("label",q,[G,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"campaign_url",placeholder:"請輸入導購Url","onUpdate:modelValue":e[2]||(e[2]=t=>s.tempArticle.campaignUrl=t),disabled:"event"===s.tempArticle.article_type},null,8,W),[[x.nr,s.tempArticle.campaignUrl]])])])):(0,i.kq)("",!0),(0,i._)("div",H,[(0,i._)("label",S,[T,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入文章名稱","onUpdate:modelValue":e[3]||(e[3]=t=>s.tempArticle.title=t)},null,512),[[x.nr,s.tempArticle.title]])])]),(0,i._)("div",Y,[(0,i._)("label",B,[K,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"author",placeholder:"請輸入作者","onUpdate:modelValue":e[4]||(e[4]=t=>s.tempArticle.author=t)},null,512),[[x.nr,s.tempArticle.author]])])]),(0,i._)("div",O,[(0,i._)("label",J,[Q,(0,i._)("div",R,[(0,i.wy)((0,i._)("input",{type:"url",class:"form-control",id:"cover_img",placeholder:"圖片網址","onUpdate:modelValue":e[5]||(e[5]=t=>s.tempArticle.coverImg=t)},null,512),[[x.nr,s.tempArticle.coverImg]]),(0,i._)("input",{type:"file",id:"coverImgFile",ref:"coverImgFile",style:{display:"none"},onChange:e[6]||(e[6]=t=>o.uploadImg())},null,544),(0,i._)("button",{type:"button",class:"btn btn-secondary",onClick:e[7]||(e[7]=t=>this.$refs.coverImgFile.click())},tt)])])]),(0,i._)("div",et,[(0,i._)("label",lt,[(0,i.wy)((0,i._)("input",{class:"form-check-input",type:"checkbox",id:"is_public","onUpdate:modelValue":e[8]||(e[8]=t=>s.tempArticle.isPublic=t)},null,512),[[x.e8,s.tempArticle.isPublic]]),it])])]),(0,i._)("div",at,[(0,i._)("div",ct,[(0,i._)("img",{src:s.tempArticle.coverImg,alt:"請上傳圖片",class:"img-fluid"},null,8,st)])])]),ot,(0,i._)("div",rt,[nt,(0,i.Wm)(r,{onEditorContent:o.editorContent,content:s.tempArticle.content},null,8,["onEditorContent","content"]),dt,(0,i._)("p",null,(0,a.zw)(s.tempArticle.content),1)])]),(0,i._)("div",pt,[ut,(0,i._)("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=(...t)=>o.emitArticle&&o.emitArticle(...t))}," 更新文章 ")])])])],512)}var ht=l(1339),_t=l(5190),bt={name:"articleModal",mixins:[ht.Z],props:{is_new:Boolean,article:{type:Object,default(){return{}}}},emits:["update_article"],data(){return{modal:{},tempArticle:{article_type:"event",title:"",create_at:0,author:"",isPublic:!1,content:"",coverImg:"",campaignUrl:""}}},components:{documentEditor:_t.Z},watch:{article(){this.tempArticle=this.article},"tempArticle.article_type"(){"event"===this.tempArticle.article_type&&(this.tempArticle.campaignUrl="")}},methods:{emitArticle(){!0===this.is_new&&(this.tempArticle.create_at=Math.floor((new Date).getTime()/1e3)),this.$emit("update_article",this.tempArticle),this.tempArticle={article_type:"",title:"",create_at:0,author:"",isPublic:!1,content:"",coverImg:"",campaignUrl:""},this.due_date=""},uploadImg(){const t=this.$refs.coverImgFile.files[0],e=new FormData;e.append("file-to-upload",t);const l="https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/upload";this.$http.post(l,e).then((t=>{t.data.success&&(console.log(t),this.tempArticle.coverImg=t.data.imageUrl)}))},editorContent(t){this.tempArticle.content=t}}},gt=l(3744);const ft=(0,gt.Z)(bt,[["render",mt]]);var wt=ft,yt=l(8944),vt={data(){return{articles:[],pageInfo:{},tempArticle:{title:"No anything",id:"No anything"},isNew:!1,isLoading:!1}},components:{ArticleModal:wt,DelModal:yt.Z},inject:["emitter"],methods:{getArticles(t=1){const e=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/articles?page=${t}`;this.$http.get(e).then((t=>{if(console.log(t),t.data.success){this.articles=t.data.articles;const{pagination:e}=t.data;this.pageInfo={pageTotal:e.total_pages,currentPage:e.current_page,hasPrev:e.has_pre,hasNext:e.has_next}}}))},openArticleModal(t,e){const l=this.$refs.articleModal;if(t)this.isNew=t,this.tempArticle={article_type:"event",isPublic:!1,content:"<p>請輸入文章內容</p>"},l.showModal();else{this.isNew=t;const i=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/article/${e}`;this.$http.get(i).then((t=>{if(console.log(t),t.data.success){const e=t.data.article;this.tempArticle={...e},l.showModal()}}))}},updateArticle(t){this.tempArticle=t;let e="https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/article",l="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/article/${t.id}`,l="put");const i=this.$refs.articleModal;this.$http[l](e,{data:this.tempArticle}).then((t=>{console.log(t),i.hideModal(),this.getArticles(),this.$httpMessageState(t,"更新文章")}))},openDelModal(t){this.tempArticle={...t};const e=this.$refs.delModal;e.showModal()},deleteArticle(t){const e=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/article/${t}`,l=this.$refs.delModal;this.isLoading=!0,this.$http.delete(e).then((t=>{this.isLoading=!1,console.log(t),l.hideModal(),this.getArticles(),this.$httpMessageState(t,"刪除文章")}))}},created(){this.getArticles()}};const kt=(0,gt.Z)(vt,[["render",A]]);var At=kt}}]);
//# sourceMappingURL=189.988add50.js.map