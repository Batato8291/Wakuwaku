"use strict";(self["webpackChunkwakuwaku"]=self["webpackChunkwakuwaku"]||[]).push([[655],{1339:function(e,t,a){var l=a(7424),d=a.n(l);t["Z"]={methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(d())(this.$refs.modal)}}},8944:function(e,t,a){a.d(t,{Z:function(){return M}});var l=a(6252),d=a(3577);const s={class:"modal fade",tabindex:"-1",ref:"modal"},n={class:"modal-dialog modal-dialog-centered"},r={class:"modal-content"},i={class:"modal-header bg-danger text-white"},o={class:"modal-title"},u=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),p={class:"modal-body"},c=(0,l.Uk)(" 是否刪除 "),h={class:"fw-bold text-danger"},m=(0,l.Uk)("? "),_=(0,l._)("br",null,null,-1),g=(0,l.Uk)(" (刪除後將無法恢復)。 "),w={class:"modal-footer"},b=(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function y(e,t,a,y,k,v){return(0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",n,[(0,l._)("div",r,[(0,l._)("div",i,[(0,l._)("h5",o,"刪除 "+(0,d.zw)(a.itemTitle),1),u]),(0,l._)("div",p,[(0,l._)("p",null,[c,(0,l._)("span",h,(0,d.zw)(a.itemTitle),1),m,_,g])]),(0,l._)("div",w,[b,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("delete-item",a.itemId))}," 確認刪除 ")])])])],512)}var k=a(1339),v={props:{itemTitle:{type:String,default(){return{}}},itemId:{type:String,default(){return{}}}},data(){return{modal:""}},mixins:[k.Z]},f=a(3744);const O=(0,f.Z)(v,[["render",y]]);var M=O},5796:function(e,t,a){a.d(t,{Z:function(){return w}});var l=a(6252),d=a(3577),s=a(9963);const n={"aria-label":"Page navigation example"},r={class:"pagination justify-content-center"},i=(0,l._)("span",{"aria-hidden":"true"},"«",-1),o=[i],u=["onClick"],p=(0,l._)("span",{"aria-hidden":"true"},"»",-1),c=[p];function h(e,t,a,i,p,h){return(0,l.wg)(),(0,l.iD)("nav",n,[(0,l._)("ul",r,[(0,l._)("li",{class:(0,d.C_)(["page-item",{disabled:1===a.pages.currentPage||0===a.pages.pageTotal}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,s.iM)((e=>h.updatePage(a.pages.currentPage-1)),["prevent"]))},o)],2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.pageTotal,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{class:(0,d.C_)(["page-item",{active:e===a.pages.currentPage}]),key:t},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((t=>h.updatePage(e)),["prevent"])},(0,d.zw)(e),9,u)],2)))),128)),(0,l._)("li",{class:(0,d.C_)(["page-item",{disabled:a.pages.currentPage===a.pages.pageTotal||0===a.pages.pageTotal}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,s.iM)((e=>h.updatePage(a.pages.currentPage+1)),["prevent"]))},c)],2)])])}var m={props:["pages"],methods:{updatePage(e){this.$emit("change-pages",e)}}},_=a(3744);const g=(0,_.Z)(m,[["render",h]]);var w=g},9655:function(e,t,a){a.r(t),a.d(t,{default:function(){return ne}});var l=a(6252),d=a(3577),s=a(9963);const n={class:"container-fluid"},r={class:"table mt-4 ps-4"},i=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{class:"ps-3"},"建立時間"),(0,l._)("th",null,"訂單ID"),(0,l._)("th",null,"E-mail"),(0,l._)("th",null,"應付金額"),(0,l._)("th",null,"是否付款"),(0,l._)("th",null,"編輯")])],-1),o={class:"ps-3"},u={class:"form-check form-switch"},p={class:"form-check-label",for:"paid"},c=["onUpdate:modelValue","onChange"],h={key:0,class:"text-success"},m={key:1,class:"text-danger"},_={class:"btn-group"},g=["onClick"],w=["onClick"];function b(e,t,a,b,y,k){const v=(0,l.up)("LoadingOverlay"),f=(0,l.up)("OrderModal"),O=(0,l.up)("DelModal"),M=(0,l.up)("Pagination");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(v,{active:y.isLoading},null,8,["active"]),(0,l._)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>k.deleteAllOrders&&k.deleteAllOrders(...e))},"deleteAll"),(0,l._)("div",n,[(0,l._)("table",r,[i,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(y.orders,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",o,(0,d.zw)(new Date(1e3*e.create_at).toLocaleDateString()),1),(0,l._)("td",null,(0,d.zw)(e.id),1),(0,l._)("td",null,(0,d.zw)(e.user.email),1),(0,l._)("td",null,"$ "+(0,d.zw)(Math.round(e.total+e.user.deliveryFee)),1),(0,l._)("td",null,[(0,l._)("div",u,[(0,l._)("label",p,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:"paid","onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>k.updateOrder(e)},null,40,c),[[s.e8,e.is_paid]]),e.is_paid?((0,l.wg)(),(0,l.iD)("span",h,"已付款")):((0,l.wg)(),(0,l.iD)("span",m,"未付款"))])])]),(0,l._)("td",null,[(0,l._)("div",_,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>k.openOrderModal(e)}," 檢視 ",8,g),(0,l._)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>k.openDelOrder(e)}," 刪除 ",8,w)])])])))),128))])])]),(0,l.Wm)(f,{ref:"orderModal",order:y.tempOrder},null,8,["order"]),(0,l.Wm)(O,{ref:"delModal","item-title":y.tempOrder.id,"item-id":y.tempOrder.id,onDeleteItem:k.deleteOrder},null,8,["item-title","item-id","onDeleteItem"]),(0,l.Wm)(M,{class:"mt-5",pages:y.pagination,onChangePages:k.changePages},null,8,["pages","onChangePages"])],64)}var y=a(8944);const k={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog modal-xl",role:"document"},f={class:"modal-content border-0"},O=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"訂單資料")]),(0,l._)("button",{type:"button",class:"btn btn-dark","data-bs-dismiss":"modal","aria-label":"Close"},[(0,l._)("i",{class:"bi bi-x-lg"})])],-1),M={class:"modal-body"},x={class:"row"},D={class:"col-sm-4"},$=(0,l._)("h3",null,"客戶資料",-1),C={class:"table"},z=(0,l._)("th",{style:{width:"100px"}},"姓名",-1),P=(0,l._)("th",{style:{width:"100px"}},"Email",-1),Z=(0,l._)("th",{style:{width:"100px"}},"電話",-1),L=(0,l._)("th",{style:{width:"100px"}},"地址",-1),T=(0,l._)("th",null,"付款方式",-1),S=(0,l._)("th",null,"備註",-1),A=(0,l._)("h3",{class:"mt-5"},"訂單資料",-1),I={class:"table"},U=(0,l._)("th",{style:{width:"100px"}},"訂單編號",-1),H=(0,l._)("th",null,"下單時間",-1),W={key:0},Y=(0,l._)("th",null,"付款時間",-1),j=(0,l._)("th",null,"付款狀態",-1),F={key:0,class:"text-success"},K={key:1,class:"text-danger"},q=(0,l._)("th",null,"總金額",-1),E={class:"col-sm-8 bg-light"},V=(0,l._)("h3",null,"選購商品",-1),N={class:"table"},X={style:{"min-width":"200px"}},B={style:{"min-width":"60px"}},G={style:{"min-width":"100px"},class:"text-end fw-bold"};function J(e,t,a,s,n,r){return(0,l.wg)(),(0,l.iD)("div",k,[(0,l._)("div",v,[(0,l._)("div",f,[O,(0,l._)("div",M,[(0,l._)("div",x,[(0,l._)("div",D,[$,(0,l._)("table",C,[(0,l._)("tbody",null,[(0,l._)("tr",null,[z,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.name),1)]),(0,l._)("tr",null,[P,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.email),1)]),(0,l._)("tr",null,[Z,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.tel),1)]),(0,l._)("tr",null,[L,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.address),1)]),(0,l._)("tr",null,[T,(0,l._)("td",null,(0,d.zw)(n.paymentMeth),1)]),(0,l._)("tr",null,[S,(0,l._)("td",null,(0,d.zw)(n.tempOrder.message),1)])])]),A,(0,l._)("table",I,[(0,l._)("tbody",null,[(0,l._)("tr",null,[U,(0,l._)("td",null,(0,d.zw)(n.tempOrder.id),1)]),(0,l._)("tr",null,[H,(0,l._)("td",null,(0,d.zw)(new Date(1e3*n.tempOrder.create_at).toLocaleDateString()),1)]),n.tempOrder.paid_date?((0,l.wg)(),(0,l.iD)("tr",W,[Y,(0,l._)("td",null,(0,d.zw)(new Date(1e3*n.tempOrder.paid_date).toLocaleDateString()),1)])):(0,l.kq)("",!0),(0,l._)("tr",null,[j,(0,l._)("td",null,[n.tempOrder.is_paid?((0,l.wg)(),(0,l.iD)("strong",F,"已付款")):((0,l.wg)(),(0,l.iD)("span",K,"尚未付款"))])]),(0,l._)("tr",null,[q,(0,l._)("td",null," $ "+(0,d.zw)(Math.round(n.tempOrder.total+n.tempOrder.user.deliveryFee)),1)])])])]),(0,l._)("div",E,[V,(0,l._)("table",N,[(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.tempOrder.products,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("th",X,(0,d.zw)(e.product.title),1),(0,l._)("td",B,"X "+(0,d.zw)(e.qty),1),(0,l._)("td",G," $ "+(0,d.zw)(Math.round(e.final_total)),1)])))),128))])])])])])])])],512)}var Q=a(1339),R={props:{order:{type:Object,default(){return{}}}},watch:{order(){this.tempOrder=this.order;const e=this.order.user.payment;"credit_card"==e?this.paymentMeth="信用卡付款 $60":"atm"==e?this.paymentMeth="ATM轉帳 $60":"mart"==e?this.paymentMeth="超商取貨付款 $75":"home_delivery"==e&&(this.paymentMeth="宅配付款 $100")}},data(){return{modal:{},tempOrder:{user:{name:"",email:"",address:"",tel:"",payment:"",deliveryFee:""}},paymentMeth:""}},mixins:[Q.Z],mounted(){this.tempOrder={...this.order}}},ee=a(3744);const te=(0,ee.Z)(R,[["render",J]]);var ae=te,le=a(5796),de={data(){return{orders:[],tempOrder:{},pagination:{currentPage:"",pageTotal:""},isLoading:!1}},components:{DelModal:y.Z,OrderModal:ae,Pagination:le.Z},inject:["emitter"],methods:{getOrders(e=1){const t=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/orders?page=${e}`;this.$http.get(t).then((e=>{e.data.success&&(this.orders=e.data.orders,e.data.pagination&&(this.pagination.currentPage=e.data.pagination.current_page,this.pagination.pageTotal=e.data.pagination.total_pages))}))},openOrderModal(){const e=this.$refs.orderModal;e.showModal()},openDelOrder(e){this.tempOrder={...e};const t=this.$refs.delModal;t.showModal()},deleteOrder(e){const t=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/order/${e}`,a=this.$refs.delModal;this.isLoading=!0,this.$http.delete(t).then((e=>{this.isLoading=!1,a.hideModal(),this.getOrders(),this.$httpMessageState(e,"刪除訂單")}))},deleteAllOrders(){const e="https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/orders/all";this.$http.delete(e).then((e=>{console.log(e)}))},updateOrder(e){const t=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/order/${e.id}`;this.$http.put(t,{data:e}).then((e=>{console.log(e)}))},openOrderModal(e){this.tempOrder={...e};const t=this.$refs.orderModal;t.showModal()},changePages(e){this.getOrders(e.currentPage)}},created(){this.getOrders()}};const se=(0,ee.Z)(de,[["render",b]]);var ne=se}}]);
//# sourceMappingURL=655.b9213064.js.map