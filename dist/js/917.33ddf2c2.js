"use strict";(self["webpackChunkwakuwaku"]=self["webpackChunkwakuwaku"]||[]).push([[917],{1339:function(t,e,s){var a=s(7424),l=s.n(a);e["Z"]={methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(l())(this.$refs.modal)}}},6917:function(t,e,s){s.r(e),s.d(e,{default:function(){return mt}});var a=s(6252),l=s(9963),d=s(3577);const i=t=>((0,a.dD)("data-v-b6351bd0"),t=t(),(0,a.Cn)(),t),c={class:"container p-0"},o={class:"cart-list"},n=(0,a.uE)('<div data-v-b6351bd0><p class="fs-1 fw-bold text-center" style="color:#faa11f;" data-v-b6351bd0> 購物車清單 </p><div class="col-12 col-lg-10 mx-lg-auto" data-v-b6351bd0><ul class="multi-steps" data-v-b6351bd0><li class="active" id="progressbar_cart" data-v-b6351bd0><span data-v-b6351bd0>購物車</span></li><li id="progressbar_order" data-v-b6351bd0><span data-v-b6351bd0>訂單資料</span></li><li id="progressbar_check" data-v-b6351bd0><span data-v-b6351bd0>確認訂單</span></li><li id="progressbar_done" data-v-b6351bd0><span data-v-b6351bd0>完成訂單</span></li></ul></div></div><div class="d-md-none" style="min-height:0.5rem;background-color:rgba(255, 173, 59, 0.856);" data-v-b6351bd0></div><div class="list-table-title d-none d-md-flex" data-v-b6351bd0><div class="col-1" data-v-b6351bd0>選取</div><div class="col-2" data-v-b6351bd0>商品圖片</div><div class="mx-2 col-8 flex-row" data-v-b6351bd0><div class="col-md-4" data-v-b6351bd0>商品名稱</div><div class="col-md-3 col-lg-2" data-v-b6351bd0>價格</div><div class="col-md-5 col-lg-4" data-v-b6351bd0>數量</div><div class="col-lg-2 d-none d-lg-flex" data-v-b6351bd0></div></div></div><hr class="my-1" style="border-width:3px;" data-v-b6351bd0>',4),r={class:"item_content align-item-center py-2"},h={class:"d-flex"},u={class:"col-1 item-check"},m=["value"],p={class:"item-img col-3 col-md-2"},b=["src"],v={class:"col-8 item-info mx-2"},g={class:"mt-2 mb-0 me-2 col-md-4"},k={class:"item-price my-2 px-2 col-md-3 col-lg-2"},_={class:"text-danger"},f={key:0,class:"text-decoration-line-through text-secondary me-2"},w={class:"counter-group col-md-5 col-lg-4"},x=["onClick","disabled"],C=i((()=>(0,a._)("i",{class:"bi bi-dash"},null,-1))),y=[C],I=["onChange","onUpdate:modelValue","disabled"],$=["onClick","disabled"],D=i((()=>(0,a._)("i",{class:"bi bi-plus"},null,-1))),M=[D],U={class:"del-btn col-lg-2"},A=(0,a.Uk)("刪除"),q=["onClick"],E={key:0,class:"d-flex align-item-center flex-column"},T=i((()=>(0,a._)("div",{class:"lg-list-item p-2 mt-3 fs-2 fw-bold text-center",style:{color:"gray"}}," 購物車沒有商品 . . . ",-1))),z={class:"d-flex justify-content-center mt-3 mb-5"},O=(0,a.Uk)(" 前往商店 "),L=i((()=>(0,a._)("i",{class:"bi bi-arrow-bar-right"},null,-1))),S={class:"cart-footer"},V={class:"footer-item check_out p-2"},Y={class:"ms-1 align-items-center d-flex"},Z={class:"ms-2 d-flex me-2",for:"select_all"},W={class:"ms-auto me-3"},H={class:"mb-0"},X=(0,a.Uk)(" 小計: "),j={class:"ms-2 text-danger fs-5"},K=["disabled"];function P(t,e,s,i,C,D){const P=(0,a.up)("router-link"),Q=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",c,[(0,a._)("div",o,[n,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(C.carts,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"item_box",key:t.id},[(0,a._)("div",r,[(0,a._)("div",h,[(0,a._)("div",u,[(0,a.wy)((0,a._)("input",{class:"form-check-input select-btn cart_item_checkbox",type:"checkbox",value:t.id,"onUpdate:modelValue":e[0]||(e[0]=t=>C.checkedItems=t)},null,8,m),[[l.e8,C.checkedItems]])]),(0,a._)("div",p,[(0,a._)("div",null,[(0,a._)("img",{src:t.product.images[0],alt:""},null,8,b)])]),(0,a._)("div",v,[(0,a._)("p",g,(0,d.zw)(t.product.title),1),(0,a._)("div",k,[(0,a._)("div",_,[(0,a.Uk)(" $"+(0,d.zw)(t.total)+" ",1),t.product.origin_price>t.product.price?((0,a.wg)(),(0,a.iD)("span",f,"$"+(0,d.zw)(t.product.origin_price*t.qty),1)):(0,a.kq)("",!0)])]),(0,a._)("div",w,[(0,a._)("button",{class:"",onClick:e=>D.updateCart(t,-1),disabled:C.status.loadingItem===t.id},y,8,x),(0,a.wy)((0,a._)("input",{type:"number",class:"qty-input",min:"1",onChange:e=>D.updateCart(t),"onUpdate:modelValue":e=>t.qty=e,disabled:C.status.loadingItem===t.id},null,40,I),[[l.nr,t.qty,void 0,{number:!0}]]),(0,a._)("button",{class:"",onClick:e=>D.updateCart(t,1),disabled:C.status.loadingItem===t.id},M,8,$)]),(0,a._)("div",U,[(0,a.Wm)(P,{to:"",onClick:e=>D.openDelModal(t)},{default:(0,a.w5)((()=>[A])),_:2},1032,["onClick"])])])])]),(0,a._)("div",{class:"item_del my-2",onClick:e=>D.openDelModal(t)},"刪除",8,q)])))),128)),0===C.carts.length?((0,a.wg)(),(0,a.iD)("div",E,[T,(0,a._)("div",z,[(0,a.Wm)(P,{class:"btn text-white fw-semibold shadow-none",to:"/search?search=&category=all",style:{"background-color":"rgb(251 164 59)"}},{default:(0,a.w5)((()=>[O,L])),_:1})])])):(0,a.kq)("",!0)]),(0,a._)("div",S,[(0,a._)("div",V,[(0,a._)("div",Y,[(0,a.wy)((0,a._)("input",{class:"form-check-input select-btn",type:"checkbox",name:"select_all",id:"select_all","onUpdate:modelValue":e[1]||(e[1]=t=>C.checkedAll=t),onClick:e[2]||(e[2]=t=>D.selectAll())},null,512),[[l.e8,C.checkedAll]]),(0,a._)("label",Z,"全選 ("+(0,d.zw)(C.carts.length)+")",1)]),(0,a._)("div",W,[(0,a._)("p",H,[X,(0,a._)("span",j,"$"+(0,d.zw)(D.totalAmount),1)])]),(0,a._)("button",{class:"btn btn-danger",disabled:0==D.totalAmount,onClick:e[3]||(e[3]=(...t)=>D.toOrder&&D.toOrder(...t))}," 結帳 ",8,K)])])]),(0,a.Wm)(Q,{ref:"delModal","item-title":C.tempCart.product.title,"item-id":C.tempCart.id,onDeleteItem:e[4]||(e[4]=t=>D.deleteCart(C.tempCart.id))},null,8,["item-title","item-id"])],64)}const Q=t=>((0,a.dD)("data-v-2e67c37e"),t=t(),(0,a.Cn)(),t),B={class:"modal fade",tabindex:"-1",ref:"modal"},F={class:"modal-dialog modal-dialog-centered"},G={class:"modal-content"},J={class:"modal-body"},N=(0,a.Uk)(" 是否從購物車移除 "),R={class:"fw-bold text-danger"},tt=(0,a.Uk)(" ? "),et=Q((()=>(0,a._)("br",null,null,-1))),st=(0,a.Uk)(" (移除後將無法恢復) "),at={class:"modal-footer"},lt=Q((()=>(0,a._)("button",{type:"button ",class:"btn esc-btn col-5 text-center","data-bs-dismiss":"modal"}," 取消 ",-1)));function dt(t,e,s,l,i,c){return(0,a.wg)(),(0,a.iD)("div",B,[(0,a._)("div",F,[(0,a._)("div",G,[(0,a._)("div",J,[(0,a._)("p",null,[N,(0,a._)("span",R,(0,d.zw)(s.itemTitle),1),tt,et,st])]),(0,a._)("div",at,[lt,(0,a._)("button",{type:"button ",class:"btn del-btn col-5 text-center",onClick:e[0]||(e[0]=e=>t.$emit("delete-item",s.itemId))}," 移除 ")])])])],512)}var it=s(1339),ct={props:{itemTitle:{type:String,default(){return{}}},itemId:{type:String,default(){return{}}}},data(){return{modal:""}},mixins:[it.Z]},ot=s(3744);const nt=(0,ot.Z)(ct,[["render",dt],["__scopeId","data-v-2e67c37e"]]);var rt=nt,ht={data(){return{carts:[],tempCart:{product:{title:""},id:""},status:{loadingItem:""},checkedItems:[],unCheckItems:[],checkedAll:!1,coupon_code:"",isCoupon:!1}},components:{DelModal:rt},watch:{checkedItems(){this.checkedItems.length===this.carts.length?this.checkedAll=!0:this.checkedAll=!1}},computed:{totalAmount(){let t=0,e=[];return this.checkedItems.forEach((s=>{let a=this.carts.filter((t=>t.id==s)),l=a[0];e.push(l),t+=l.total})),console.log("matchItem",e),t}},methods:{itemSwipe(){let t=null;const e=document.querySelectorAll(".cart-list .item_box");for(let s=0;s<e.length;s++){let a,l,d,i,c,o;e[s].addEventListener("touchstart",(function(e){a=e.changedTouches[0].pageX,l=e.changedTouches[0].pageY,c=!0,o=!0,t&&t.classList.remove("swipeleft")})),e[s].addEventListener("touchmove",(function(e){d=e.changedTouches[0].pageX,i=e.changedTouches[0].pageY,c&&Math.abs(d-a)-Math.abs(i-l)>0&&(e.stopPropagation(),d-a>10&&(e.preventDefault(),this.classList.remove("swipeleft")),a-d>10&&(e.preventDefault(),this.classList.add("swipeleft"),t=this),o=!1),o&&Math.abs(d-a)-Math.abs(i-l)<0&&(c=!1)}))}},getCarts(){const t="https://vue3-course-api.hexschool.io/api/wakuwaku-api/cart";this.unCheckItems=[],this.$http.get(t).then((t=>{this.carts=t.data.data.carts,this.carts.forEach((t=>this.unCheckItems.push(t.id))),console.log("cart",this.carts,"uncheck",this.unCheckItems),window.screen.width<992&&this.$nextTick((()=>{this.itemSwipe()})),this.$emitter.emit("cartsUpdate",{})}))},updateCart(t,e){console.log("change Qty"),this.status.loadingItem=t.id;const s=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/cart/${t.id}`;let a;if(a=e?t.qty+e:t.qty,a<=0)return this.openDelModal(t),void(this.status.loadingItem="");const l={product_id:t.product_id,qty:a};this.$http.put(s,{data:l}).then((t=>{console.log(t),this.getCarts(),this.status.loadingItem=""}))},openDelModal(t){this.tempCart={...t};const e=this.$refs.delModal;e.showModal()},deleteCart(t){const e=this.$refs.delModal,s=this.checkedItems.indexOf(t);-1!=s&&this.checkedItems.splice(s,1);const a=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/cart/${t}`;this.$http.delete(a).then((t=>{console.log(t),e.hideModal(),this.getCarts()}))},selectAll(){this.checkedAll?this.checkedItems=[]:this.carts.forEach((t=>{-1==this.checkedItems.indexOf(t.id)&&this.checkedItems.push(t.id)}))},toOrder(){let t=this.unCheckItems.filter((t=>-1===this.checkedItems.indexOf(t)));console.log("result",t),t.forEach((t=>{let e=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/cart/${t}`;this.$http.delete(e).then((t=>{console.log(t),this.$emitter.emit("cartsUpdate",{})}))})),this.$router.push("/order")}},created(){this.getCarts()},mounted(){}};const ut=(0,ot.Z)(ht,[["render",P],["__scopeId","data-v-b6351bd0"]]);var mt=ut}}]);
//# sourceMappingURL=917.33ddf2c2.js.map