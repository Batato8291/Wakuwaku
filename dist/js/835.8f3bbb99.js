"use strict";(self["webpackChunkwakuwaku"]=self["webpackChunkwakuwaku"]||[]).push([[835],{5796:function(t,e,l){l.d(e,{Z:function(){return b}});var o=l(6252),a=l(3577),s=l(9963);const i={"aria-label":"Page navigation example"},r={class:"pagination justify-content-center"},c=(0,o._)("span",{"aria-hidden":"true"},"«",-1),n=[c],d=["onClick"],u=(0,o._)("span",{"aria-hidden":"true"},"»",-1),p=[u];function m(t,e,l,c,u,m){return(0,o.wg)(),(0,o.iD)("nav",i,[(0,o._)("ul",r,[(0,o._)("li",{class:(0,a.C_)(["page-item",{disabled:1===l.pages.currentPage||0===l.pages.pageTotal}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,s.iM)((t=>m.updatePage(l.pages.currentPage-1)),["prevent"]))},n)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.pages.pageTotal,((t,e)=>((0,o.wg)(),(0,o.iD)("li",{class:(0,a.C_)(["page-item",{active:t===l.pages.currentPage}]),key:e},[(0,o._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((e=>m.updatePage(t)),["prevent"])},(0,a.zw)(t),9,d)],2)))),128)),(0,o._)("li",{class:(0,a.C_)(["page-item",{disabled:l.pages.currentPage===l.pages.pageTotal||0===l.pages.pageTotal}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,s.iM)((t=>m.updatePage(l.pages.currentPage+1)),["prevent"]))},p)],2)])])}var h={props:["pages"],methods:{updatePage(t){this.$emit("change-pages",t)}}},g=l(3744);const _=(0,g.Z)(h,[["render",m]]);var b=_},8135:function(t,e,l){l.r(e),l.d(e,{default:function(){return oe}});var o=l(6252),a=l(3577),s=l(1159);const i={class:"container-fluid"},r={class:"col-6"},c={class:"text-end"},n={class:"table mt-4"},d=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{class:"col-1"},"類別"),(0,o._)("th",{class:"col-2"},"縮圖"),(0,o._)("th",{class:"col-2"},"系列名稱"),(0,o._)("th",{class:"col-2"},"產品名稱"),(0,o._)("th",{class:"col-1"},"原價"),(0,o._)("th",{class:"col-1"},"售價"),(0,o._)("th",{class:"col-1"},"是否啟用"),(0,o._)("th",{class:"col-2"},"編輯")])],-1),u={class:"fw-bolder"},p=["src"],m={key:1,style:{"max-height":"150px"},src:s,alt:""},h={class:"text-right"},g={class:"text-right"},_={key:0,class:"text-success fw-bolder"},b={key:1,class:"text-danger fw-bolder"},f={class:"btn-group"},v=["onClick"],P=["onClick"];function w(t,e,l,s,w,y){const k=(0,o.up)("LoadingOverlay"),C=(0,o.up)("Pagination"),x=(0,o.up)("ProductModal"),U=(0,o.up)("DelModal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(k,{active:w.isLoading},null,8,["active"]),(0,o._)("div",i,[(0,o._)("div",r,[(0,o._)("button",{class:(0,a.C_)(["btn btn-outline-secondary btn-lg me-4 col-2","all"===w.isActive?"active":""]),onClick:e[0]||(e[0]=t=>(y.filterByCategory(this.products),w.isActive="all"))}," # All ",2),(0,o._)("button",{class:(0,a.C_)(["btn btn-outline-secondary btn-lg me-4 col-2","comic"===w.isActive?"active":""]),onClick:e[1]||(e[1]=t=>(y.filterByCategory(this.products,"comic"),w.isActive="comic"))}," # Comic ",2),(0,o._)("button",{class:(0,a.C_)(["btn btn-outline-secondary btn-lg me-4 col-2","lightNovel"===w.isActive?"active":""]),onClick:e[2]||(e[2]=t=>(y.filterByCategory(this.products,"lightNovel"),w.isActive="lightNovel"))}," # LightNovel ",2),(0,o._)("button",{class:(0,a.C_)(["btn btn-outline-secondary btn-lg me-4 col-2","novel"===w.isActive?"active":""]),onClick:e[3]||(e[3]=t=>(y.filterByCategory(this.products,"novel"),w.isActive="novel"))}," # Novel ",2),(0,o._)("button",{class:(0,a.C_)(["btn btn-outline-secondary btn-lg me-4 col-2","nonfiction"===w.isActive?"active":""]),onClick:e[4]||(e[4]=t=>(y.filterByCategory(this.products,"nonfiction"),w.isActive="nonfiction"))}," # Nonfiction ",2)]),(0,o._)("div",c,[(0,o._)("button",{class:"btn btn-warning me-5",onClick:e[5]||(e[5]=t=>y.hurryCreate(!0,w.lastProduct))}," 微 ‧ 加快生產 o'_'o "),(0,o._)("button",{class:"btn btn-primary me-5",onClick:e[6]||(e[6]=t=>y.openModal(!0))}," 增加一個產品 ")]),(0,o._)("table",n,[d,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(w.nowPageData,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id},[(0,o._)("td",u,(0,a.zw)(e.category),1),(0,o._)("td",null,[e.images?((0,o.wg)(),(0,o.iD)("img",{key:0,style:{"max-height":"150px"},src:e.images[0],alt:""},null,8,p)):((0,o.wg)(),(0,o.iD)("img",m))]),(0,o._)("td",null,(0,a.zw)(e.series),1),(0,o._)("td",null,(0,a.zw)(e.title),1),(0,o._)("td",h,(0,a.zw)(t.$filters.currency(e.origin_price)),1),(0,o._)("td",g,(0,a.zw)(t.$filters.currency(e.price)),1),(0,o._)("td",null,[e.is_enabled?((0,o.wg)(),(0,o.iD)("span",_,"啟用")):((0,o.wg)(),(0,o.iD)("span",b,"未啟用"))]),(0,o._)("td",null,[(0,o._)("div",f,[(0,o._)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>y.openModal(!1,e)}," 編輯 ",8,v),(0,o._)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>y.openDelModal(e)}," 刪除 ",8,P)])])])))),128))])])]),(0,o.Wm)(C,{pages:w.pageInfo,onChangePages:y.pagination},null,8,["pages","onChangePages"]),(0,o.Wm)(x,{ref:"productModal",product:w.tempProduct,onUpdateProduct:y.updateProduct},null,8,["product","onUpdateProduct"]),(0,o.Wm)(U,{ref:"delModal","item-title":w.tempProduct.title,"item-id":w.tempProduct.id,onDeleteItem:y.deleteProduct},null,8,["item-title","item-id","onDeleteItem"])],64)}var y=l(9963);const k={class:"modal fade",id:"productModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true",ref:"modal"},C={class:"modal-dialog modal-xl modal-dialog-scrollable",role:"document"},x={class:"modal-content border-2"},U=(0,o._)("div",{class:"modal-header bg-secondary text-white"},[(0,o._)("h5",{class:"modal-title",id:"productModalLabel"},[(0,o._)("span",null,"新增產品")]),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),V={class:"modal-body"},D={class:"row"},M={class:"col-sm-4"},I={class:"mb-3"},T={for:"image",class:"form-label"},A=(0,o.Uk)("輸入圖片網址 "),W={class:"mb-3"},$={for:"customFile",class:"form-label"},N=(0,o.Uk)("或 上傳圖片 "),F=(0,o._)("i",{class:"fas fa-spinner fa-spin"},null,-1),q=["src"],L={class:"mt-2"},z=["disabled"],E={key:0,class:"mt-5"},B=["src"],Z=["onUpdate:modelValue"],H=["onClick"],O={class:"col-sm-8"},S={class:"row"},j={class:"mb-3 col-md-4"},Y=(0,o._)("label",{for:"series",class:"form-label w-100"},"系列",-1),K={class:"mb-3 col-md-4"},G=(0,o._)("label",{for:"title",class:"form-label w-100"},"書名",-1),J={class:"mb-3 col-md-4"},Q=(0,o._)("label",{for:"subtitle",class:"form-label w-100"},"副標題",-1),R={class:"row"},X={class:"mb-3 col-md-4"},tt=(0,o._)("label",{for:"publisher",class:"form-label w-100"},"出版社",-1),et={class:"row"},lt={class:"mb-3 col-md-3"},ot=(0,o._)("label",{for:"author",class:"form-label w-100"},'作者 (多位用","隔開)',-1),at={class:"mb-3 col-md-3"},st=(0,o._)("label",{for:"original_author",class:"form-label w-100"},"原作",-1),it={class:"mb-3 col-md-3"},rt=(0,o._)("label",{for:"illustrator",class:"form-label w-100"},"繪師",-1),ct={class:"mb-3 col-md-3"},nt=(0,o._)("label",{for:"translator",class:"form-label w-100"},"譯者",-1),dt={class:"row"},ut={class:"mb-3 col-md-3"},pt=(0,o._)("label",{class:"form-label w-100",for:"category"},"分類 ",-1),mt=(0,o._)("option",{value:"",selected:"",disabled:""},"請選擇分類",-1),ht=(0,o._)("option",{value:"comic"},"漫畫",-1),gt=(0,o._)("option",{value:"lightNovel"},"輕小說",-1),_t=(0,o._)("option",{value:"novel"},"文學小說",-1),bt=(0,o._)("option",{value:"nonfiction"},"一般書、其他",-1),ft={class:"mb-3 col-md-3"},vt=(0,o._)("label",{for:"pub_date",class:"form-label w-100"},"出版日期",-1),Pt={class:"mb-3 col-md-2"},wt=(0,o._)("label",{for:"pages_num",class:"form-label w-100"},"頁數",-1),yt={class:"mb-3 col-md-2"},kt=(0,o._)("label",{class:"form-label w-100",for:"origin_price"},"原價",-1),Ct={class:"mb-3 col-md-2"},xt=(0,o._)("label",{class:"form-label w-100",for:"price"},"售價",-1),Ut={key:0,class:"mb-3"},Vt=(0,o._)("label",{for:"product_tags",class:"form-label d-block"},"作品標籤",-1),Dt=["id","value"],Mt=["for"],It=(0,o._)("hr",null,null,-1),Tt={class:"mb-3 pe-3"},At=(0,o._)("label",{for:"des_short",class:"form-label w-100"},"簡介 (50字內) ",-1),Wt={class:"mb-3 pe-3"},$t=(0,o._)("p",null,"內容介紹",-1),Nt={class:"mb-3 pe-3"},Ft=(0,o._)("p",null,"作者簡介",-1),qt={class:"mb-3 d-flex"},Lt={class:"form-check"},zt={class:"form-check-label",for:"is_enabled"},Et=(0,o.Uk)(" 是否啟用 "),Bt={class:"form-check ms-5"},Zt={class:"form-check-label",for:"is_popular"},Ht=(0,o.Uk)(" 是否熱門 (因為沒有實際銷售,以此模擬) "),Ot=(0,o._)("div",{class:"modal-footer"},[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),(0,o._)("button",{type:"submit",form:"productForm",class:"btn btn-primary"}," 確認 ")],-1);function St(t,e,l,s,i,r){const c=(0,o.up)("VField"),n=(0,o.up)("ErrorMessage"),d=(0,o.up)("text-editor"),u=(0,o.up)("VForm");return(0,o.wg)(),(0,o.iD)("div",k,[(0,o._)("div",C,[(0,o._)("div",x,[U,(0,o._)("div",V,[(0,o.Wm)(u,{ref:"productForm",id:"productForm",onSubmit:e[22]||(e[22]=e=>(r.changePriceType(i.tempProduct),r.splitAuthor(),t.$emit("update-product",i.tempProduct)))},{default:(0,o.w5)((({errors:t})=>[(0,o._)("div",D,[(0,o._)("div",M,[(0,o._)("div",I,[(0,o._)("label",T,[A,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=t=>i.tempImgUrl=t)},null,512),[[y.nr,i.tempImgUrl]])])]),(0,o._)("div",W,[(0,o._)("label",$,[N,F,(0,o._)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>r.uploadFile&&r.uploadFile(...t))},null,544)])]),(0,o._)("img",{class:"img-fluid",src:i.tempImgUrl,alt:""},null,8,q),(0,o._)("div",L,[(0,o._)("button",{onClick:e[2]||(e[2]=(...t)=>r.newImg&&r.newImg(...t)),class:"btn btn-outline-primary btn-sm d-block w-100",disabled:""==i.tempImgUrl}," 新增圖片 (建議 4:3) ",8,z)]),i.tempProduct.images?((0,o.wg)(),(0,o.iD)("div",E,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.tempProduct.images,((t,e)=>((0,o.wg)(),(0,o.iD)("div",{key:e,class:"mb-3 input-group input-group-sm"},[(0,o._)("img",{class:"img-fluid w-100",src:t,alt:""},null,8,B),(0,o.wy)((0,o._)("input",{type:"url",class:"form-control","onUpdate:modelValue":t=>i.tempProduct.images[e]=t,placeholder:"請輸入連結"},null,8,Z),[[y.nr,i.tempProduct.images[e]]]),(0,o._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>i.tempProduct.images.splice(e,1)}," 移除 ",8,H)])))),128))])):(0,o.kq)("",!0)]),(0,o._)("div",O,[(0,o._)("div",S,[(0,o._)("div",j,[Y,(0,o.Wm)(c,{type:"text",class:(0,a.C_)(["form-control",{"is-invalid":t["系列"]}]),name:"系列",id:"series",placeholder:"請輸入系列名稱",rules:"required",modelValue:i.tempProduct.series,"onUpdate:modelValue":e[3]||(e[3]=t=>i.tempProduct.series=t)},null,8,["class","modelValue"])]),(0,o._)("div",K,[G,(0,o.Wm)(c,{type:"text",class:(0,a.C_)(["form-control",{"is-invalid":t["書名"]}]),id:"title",placeholder:"請輸入書名",modelValue:i.tempProduct.title,"onUpdate:modelValue":e[4]||(e[4]=t=>i.tempProduct.title=t),name:"書名",rules:"required"},null,8,["modelValue","class"]),(0,o.Wm)(n,{name:"書名",class:"invalid-feedback"})]),(0,o._)("div",J,[Q,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"subtitle",placeholder:"請輸入副標題","onUpdate:modelValue":e[5]||(e[5]=t=>i.tempProduct.subtitle=t)},null,512),[[y.nr,i.tempProduct.subtitle]])])]),(0,o._)("div",R,[(0,o._)("div",X,[tt,(0,o.Wm)(c,{type:"text",class:(0,a.C_)(["form-control",{"is-invalid":t["出版社"]}]),id:"publisher",placeholder:"請輸入出版社",modelValue:i.tempProduct.publisher,"onUpdate:modelValue":e[6]||(e[6]=t=>i.tempProduct.publisher=t),name:"出版社",rules:"required"},null,8,["modelValue","class"]),(0,o.Wm)(n,{name:"出版社",class:"invalid-feedback"})])]),(0,o._)("div",et,[(0,o._)("div",lt,[ot,(0,o.Wm)(c,{type:"text",class:(0,a.C_)(["form-control",{"is-invalid":t["作者"]}]),id:"author",placeholder:"請輸入作者",modelValue:i.tempProduct.author,"onUpdate:modelValue":e[7]||(e[7]=t=>i.tempProduct.author=t),name:"作者",rules:"required"},null,8,["modelValue","class"]),(0,o.Wm)(n,{name:"作者",class:"invalid-feedback"})]),(0,o._)("div",at,[st,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"original_author",placeholder:"請輸入原作者","onUpdate:modelValue":e[8]||(e[8]=t=>i.tempProduct.original_author=t)},null,512),[[y.nr,i.tempProduct.original_author]])]),(0,o._)("div",it,[rt,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"illustrator",placeholder:"請輸入繪師","onUpdate:modelValue":e[9]||(e[9]=t=>i.tempProduct.illustrator=t)},null,512),[[y.nr,i.tempProduct.illustrator]])]),(0,o._)("div",ct,[nt,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"translator",placeholder:"請輸入譯者","onUpdate:modelValue":e[10]||(e[10]=t=>i.tempProduct.translator=t)},null,512),[[y.nr,i.tempProduct.translator]])])]),(0,o._)("div",dt,[(0,o._)("div",ut,[pt,(0,o.Wm)(c,{as:"select",class:(0,a.C_)(["form-select",{"is-invalid":t["分類"]}]),modelValue:i.tempProduct.category,"onUpdate:modelValue":e[11]||(e[11]=t=>i.tempProduct.category=t),id:"category",name:"分類",rules:"required"},{default:(0,o.w5)((()=>[mt,ht,gt,_t,bt])),_:2},1032,["modelValue","class"]),(0,o.Wm)(n,{name:"分類",class:"invalid-feedback"})]),(0,o._)("div",ft,[vt,(0,o.wy)((0,o._)("input",{type:"date",class:"form-control",id:"pub_date","onUpdate:modelValue":e[12]||(e[12]=t=>i.pub_date=t)},null,512),[[y.nr,i.pub_date]])]),(0,o._)("div",Pt,[wt,(0,o.wy)((0,o._)("input",{type:"number",min:"1",class:"form-control",id:"pages_num",placeholder:"頁數","onUpdate:modelValue":e[13]||(e[13]=t=>i.tempProduct.pages_num=t)},null,512),[[y.nr,i.tempProduct.pages_num]])]),(0,o._)("div",yt,[kt,(0,o.Wm)(c,{type:"number",min:"0",class:(0,a.C_)(["form-control",{"is-invalid":t["原價"]}]),id:"origin_price",placeholder:"原價",modelValue:i.tempProduct.origin_price,"onUpdate:modelValue":e[14]||(e[14]=t=>i.tempProduct.origin_price=t),name:"原價",rules:"numeric|min:0|required"},null,8,["modelValue","class"]),(0,o.Wm)(n,{name:"原價",class:"invalid-feedback"})]),(0,o._)("div",Ct,[xt,(0,o.Wm)(c,{type:"number",min:"0",class:(0,a.C_)(["form-control",{"is-invalid":t["售價"]}]),id:"price",placeholder:"售價",modelValue:i.tempProduct.price,"onUpdate:modelValue":e[15]||(e[15]=t=>i.tempProduct.price=t),name:"售價",rules:"numeric|min:0|required"},null,8,["modelValue","class"]),(0,o.Wm)(n,{name:"售價",class:"invalid-feedback"})])]),i.tempProduct.category?((0,o.wg)(),(0,o.iD)("div",Ut,[Vt,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.tempTags,((t,l)=>((0,o.wg)(),(0,o.iD)("div",{class:"form-check form-check-inline",key:l},[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox",id:"Tag"+l,value:t,"onUpdate:modelValue":e[16]||(e[16]=t=>i.tempProduct.tags=t)},null,8,Dt),[[y.e8,i.tempProduct.tags]]),(0,o._)("label",{class:"form-check-label",for:"Tag"+l},(0,a.zw)(t),9,Mt)])))),128))])):(0,o.kq)("",!0),It,(0,o._)("div",Tt,[At,(0,o.wy)((0,o._)("textarea",{type:"text",class:"form-control",ref:"testTx",id:"short_des",placeholder:"請輸入簡介",style:{"min-height":"110px",overflow:"hidden",resize:"none"},"onUpdate:modelValue":e[17]||(e[17]=t=>i.tempProduct.des_short=t),onInput:e[18]||(e[18]=(...t)=>r.txAutogrow&&r.txAutogrow(...t)),onFocus:e[19]||(e[19]=(...t)=>r.txAutogrow&&r.txAutogrow(...t))},null,544),[[y.nr,i.tempProduct.des_short]])]),(0,o._)("div",Wt,[$t,(0,o.Wm)(d,{onEditorContent:r.editorDescription,content:i.tempProduct.description},null,8,["onEditorContent","content"])]),(0,o._)("div",Nt,[Ft,(0,o.Wm)(d,{onEditorContent:r.editorAuthorDes,content:i.tempProduct.author_des},null,8,["onEditorContent","content"])]),(0,o._)("div",qt,[(0,o._)("div",Lt,[(0,o._)("label",zt,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":e[20]||(e[20]=t=>i.tempProduct.is_enabled=t)},null,512),[[y.e8,i.tempProduct.is_enabled]]),Et])]),(0,o._)("div",Bt,[(0,o._)("label",Zt,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox",id:"is_popular","onUpdate:modelValue":e[21]||(e[21]=t=>i.tempProduct.is_popular=t)},null,512),[[y.e8,i.tempProduct.is_popular]]),Ht])])])])])])),_:1},512)]),Ot])])],512)}var jt=l(7424),Yt=l.n(jt),Kt=l(5190),Gt={props:{product:{type:Object,default(){return{}}}},components:{textEditor:Kt.Z},watch:{product(){if(this.tempProduct=this.product,Object.prototype.hasOwnProperty.call(this.tempProduct,"pub_date")){const t=new Date(1e3*this.tempProduct.pub_date).toISOString().split("T");[this.pub_date]=t}this.tempProduct.images||(this.tempProduct.images=[])},pub_date(){this.tempProduct.pub_date=Math.floor(new Date(this.pub_date)/1e3)},"tempProduct.category":function(t){"comic"===t?this.tempTags=this.comicTags:"lightNovel"===t?this.tempTags=this.lightNovelTags:"novel"===t?this.tempTags=this.novelTags:"nonfiction"===t&&(this.tempTags=this.nonfictionTags)}},data(){return{modal:{},tempProduct:{category:void 0,description:"",author_des:""},tempDes:"",pub_date:"",tempImgUrl:"",tempTags:[],comicTags:["校園","戀愛","喜劇","溫馨","家庭","職場","百合","友情","科幻、奇幻","穿越","轉生","冒險","熱血","搞笑","懸疑","推理","音樂","恐怖","後宮","私心推薦"],lightNovelTags:["校園","青春","戀愛","喜劇","溫馨","家庭","百合","冒險","奇幻","科幻","懸疑推理","文學","歷史","武俠","恐怖","私心推薦"],novelTags:["文學","科幻","懸疑推理","愛情","歷史","武俠","恐怖","私心推薦"],nonfictionTags:["社會人文","哲學","心靈勵志","溝通","商業理財","個人規劃","投資學","經濟/趨勢","人物傳記","親子關係","自然科學","醫療常識","語言學習","私心推薦"]}},methods:{showModal(){this.modal.show(),this.tempImgUrl=""},hideModal(){this.modal.hide()},txAutogrow(){const t=document.querySelectorAll("textarea"),e=[...t];e.forEach((t=>{""===t.value?t.style.height="110px":t.style.height=`${t.scrollHeight}px`}))},uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const l="https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/upload";this.$http.post(l,e).then((t=>{t.data.success&&(this.tempImgUrl=t.data.imageUrl)}))},newImg(){this.tempProduct.images.push(this.tempImgUrl),this.tempImgUrl=""},splitAuthor(){if("string"===typeof this.tempProduct.author){const t=this.tempProduct.author.split(",");this.tempProduct.author=t}if("string"===typeof this.tempProduct.original_author){const t=this.tempProduct.original_author.split(",");this.tempProduct.original_author=t}if("string"===typeof this.tempProduct.illustrator){const t=this.tempProduct.illustrator.split(",");this.tempProduct.illustrator=t}if("string"===typeof this.tempProduct.translator){const t=this.tempProduct.translator.split(",");this.tempProduct.translator=t}},editorDescription(t){this.tempProduct.description=t},editorAuthorDes(t){this.tempProduct.author_des=t},changePriceType(t){t.origin_price=parseInt(t.origin_price),t.price=parseInt(t.price)}},mounted(){this.modal=new(Yt())(this.$refs.modal)}},Jt=l(3744);const Qt=(0,Jt.Z)(Gt,[["render",St]]);var Rt=Qt,Xt=l(8944),te=l(5796),ee={data(){return{products:[],filteredProducts:[],nowPageData:[],pageInfo:{perPage:10,pageTotal:0,currentPage:1,hasPrev:!1,hasNext:!1},tempCategory:"",tempProduct:{title:"",id:""},isNew:!1,isLoading:!1,isActive:"all",lastProduct:{}}},components:{ProductModal:Rt,DelModal:Xt.Z,Pagination:te.Z},inject:["emitter"],methods:{getProducts(t="all",e=1){const l="https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/products/all";this.isLoading=!0,this.$http.get(l).then((l=>{this.isLoading=!1,l.data.success&&(this.products=l.data.products,this.filterByCategory(this.products,t,e))}))},filterByCategory(t,e,l=1){const o=Object.values(t).reverse();e&&"all"!==e?(this.filteredProducts=o.filter((t=>t.category===e)),this.isActive=e):(this.filteredProducts=o,this.isActive="all"),this.pagination(l)},updateProduct(t){this.tempProduct=t,this.lastProduct=t;let e="https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/product",l="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/product/${t.id}`,l="put");const o=this.$refs.productModal;this.$http[l](e,{data:this.tempProduct}).then((e=>{o.hideModal(),this.getProducts(t.category,this.pageInfo.currentPage),this.$httpMessageState(e,"更新產品")}))},openModal(t,e){t?this.tempProduct={description:"<p>請輸入文章內容</p>",author_des:"<p>請輸入作者簡介</p>",unit:"unit",tags:[],is_enabled:!1}:(this.tempProduct={...e},this.tempProduct.tags||(this.tempProduct.tags=[])),this.isNew=t;const l=this.$refs.productModal;l.showModal()},hurryCreate(t,e){this.tempProduct={...e},this.tempProduct.images=[],this.tempProduct.description="",this.isNew=t;const l=this.$refs.productModal;l.showModal()},openDelModal(t){this.tempProduct={...t};const e=this.$refs.delModal;e.showModal()},deleteProduct(t){const e=`https://vue3-course-api.hexschool.io/api/wakuwaku-api/admin/product/${t}`,l=this.$refs.delModal;this.isLoading=!0,this.$http.delete(e).then((t=>{this.isLoading=!1,l.hideModal(),this.getProducts(),this.$httpMessageState(t,"刪除產品")}))},pagination(t,e=this.filteredProducts){let l=t;const o=e.length,a=this.pageInfo.perPage,s=Math.ceil(o/a);l>s&&(l=s);const i=l*a-a+1,r=l*a,c=[];e.forEach(((t,e)=>{const l=e+1;l>=i&&l<=r&&c.push(t)}));const n={perPage:a,pageTotal:s,currentPage:l,hasPrev:l>1,hasNext:l<s};this.nowPageData=c,this.pageInfo=n},changePriceType(t){t.origin_price=parseInt(t.origin_price),t.price=parseInt(t.price)}},created(){this.getProducts()}};const le=(0,Jt.Z)(ee,[["render",w]]);var oe=le}}]);
//# sourceMappingURL=835.8f3bbb99.js.map